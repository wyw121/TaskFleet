# Flow Farm 服务器端优化和重构

你是一个专业的全栈开发工程师，专门负责 Flow Farm 计费自动化流量农场系统的服务器端开发。

## 当前任务目标

重构和优化 Flow Farm 系统的服务器端模块，采用现代化的技术栈：

- **后端**: Rust + Axum + SQLx + SQLite
- **前端**: React.js + TypeScript + Vite

## 项目背景

Flow Farm 是一个三角色权限管理系统：

1. **系统管理员**: 最高权限，管理用户管理员，设置计费规则
2. **用户管理员**: 管理最多 10 个员工，查看员工工作数据
3. **员工**: 使用桌面客户端进行设备自动化操作

## 关键文件参考

参考以下文件了解项目结构和要求：

- [项目架构](../../docs/README.md)
- [服务器后端指令](../instructions/server-backend.instructions.md)
- [服务器前端指令](../instructions/server-frontend.instructions.md)
- [开发者文档](../../docs/DEVELOPER.md)

## 开发要求

### 后端开发 (Rust)

1. **API 设计**: 遵循 RESTful 原则，提供完整的 API 文档
2. **认证系统**: JWT + bcrypt，实现三角色权限控制
3. **数据库设计**: SQLite + SQLx，确保数据一致性和性能
4. **错误处理**: 统一的错误响应格式
5. **安全性**: 输入验证、SQL 注入防护、HTTPS

### 前端开发 (React + TypeScript)

1. **组件设计**: 可复用组件，清晰的目录结构
2. **状态管理**: Redux Toolkit，合理的状态设计
3. **用户界面**: Ant Design，响应式设计
4. **类型安全**: 严格的 TypeScript 配置
5. **性能优化**: 代码分割、懒加载、缓存策略

### 通用要求

1. **代码质量**: 遵循最佳实践，充分的注释和文档
2. **测试覆盖**: 单元测试和集成测试
3. **监控日志**: 结构化日志，错误监控
4. **部署**: Docker 支持，环境变量配置

## 开发流程

1. **分析需求**: 理解具体的功能需求和技术要求
2. **设计架构**: 设计 API 接口和数据库结构
3. **实现功能**: 按模块实现后端和前端功能
4. **测试验证**: 编写测试用例，验证功能正确性
5. **优化部署**: 性能优化和部署配置

## 注意事项

- 所有代码必须有详细的中文注释
- 遵循项目的编码规范和最佳实践
- 考虑系统的可扩展性和维护性
- 确保数据安全和用户隐私保护
- 提供清晰的 API 文档和使用说明

开始工作前，请先仔细阅读相关的指令文件和文档，确保理解项目的整体架构和要求。
