# Flow Farm 设备管理使用指南

## 🚀 功能概述

Flow Farm 设备管理模块现已支持完整的Android设备检测、连接和管理功能。

## ✨ 新增功能

### 1. 实时设备扫描
- ✅ **智能扫描按钮**: 点击"扫描设备"自动检测所有连接的Android设备
- ✅ **自动检测**: 启动时自动扫描可用设备
- ✅ **支持模拟器**: 完美支持雷电、夜神等Android模拟器

### 2. 设备状态监控
- 🟢 **在线**: 设备正常连接且可用
- 🔴 **离线**: 设备断开或不可用
- 🟡 **连接中**: 正在建立连接
- 🔵 **工作中**: 设备正在执行任务

### 3. 日志反馈系统
- 📋 **实时日志**: 底部显示所有操作的详细日志
- 🕐 **时间戳**: 每条日志都有精确的时间记录
- 🎨 **彩色图标**: 不同级别的日志用不同图标区分
  - ℹ️ 信息 (Info)
  - ✅ 成功 (Success)
  - ⚠️ 警告 (Warning)
  - ❌ 错误 (Error)

### 4. 设备管理操作
- 🔌 **连接/断开**: 一键切换设备连接状态
- 🧪 **设备测试**: 获取设备详细信息
  - 设备型号和Android版本
  - 屏幕分辨率
  - 电池电量
  - 已安装的目标应用（抖音、小红书等）

## 🛠️ 使用方法

### 启动设备管理
```bash
cd employee-client
python src/main.py --gui --debug
```

### 操作步骤

1. **启动程序**
   - 程序会自动检测系统中的ADB工具
   - 找到ADB后会立即扫描设备

2. **扫描设备**
   - 点击"➕ 扫描设备"按钮
   - 观察日志区域的扫描进度
   - 扫描完成后设备列表会更新

3. **查看设备信息**
   - 设备表格显示：设备名称、ID、状态、最后连接时间
   - 每个设备都有"连接"和"测试"操作按钮

4. **测试设备功能**
   - 点击设备对应的"测试"按钮
   - 在日志区域查看设备详细信息
   - 包括型号、系统版本、分辨率、电量等

5. **监控日志**
   - 日志区域实时显示所有操作状态
   - 自动滚动到最新消息
   - 可以看到设备扫描、连接等详细过程

## 🔧 技术特性

### ADB集成
- 自动查找系统中的ADB工具
- 支持常见模拟器的ADB路径
- 处理中文编码问题，避免显示乱码

### 异步操作
- 使用QTimer避免界面冻结
- 后台执行设备扫描和检测
- 实时更新界面状态

### 错误处理
- 完善的异常捕获和处理
- 详细的错误信息显示
- 智能重试机制

## 📱 支持的设备

### Android设备
- 真实的Android手机/平板
- 需要开启USB调试模式

### Android模拟器
- ✅ 雷电模拟器 (LDPlayer)
- ✅ 夜神模拟器 (NoxPlayer)
- ✅ BlueStacks
- ✅ 其他标准Android模拟器

## 🚫 故障排除

### 设备检测不到
1. **检查USB调试**
   ```
   设置 → 开发者选项 → USB调试 (开启)
   ```

2. **重新授权**
   - 断开设备重新连接
   - 在设备上点击"允许"USB调试

3. **检查ADB驱动**
   - 确保正确安装了设备驱动
   - 重启ADB服务

### 编码错误
- 程序已处理中文编码问题
- 错误不影响功能正常使用
- 显示"found X devices"表示检测成功

### 连接超时
1. 检查设备是否锁屏
2. 确认USB线连接稳定
3. 重启设备和程序

## 📝 日志示例

```
[17:35:54] 🚀 Flow Farm 设备管理器已启动
[17:35:55] 💡 点击'扫描设备'来查找可用的Android设备
[17:35:57] ℹ️ 开始扫描设备...
[17:35:58] ✅ 发现设备: 雷电模拟器 (emulator-5554)
[17:35:59] ✅ 发现设备: 小米手机 (192.168.1.100:5555)
[17:36:00] ✅ 扫描完成，共发现 2 台设备
[17:36:05] ℹ️ 测试设备: 雷电模拟器
[17:36:06] ℹ️ 设备型号: LDPlayer
[17:36:06] ℹ️ Android版本: 9
[17:36:06] ℹ️ 屏幕分辨率: 1080x1920
[17:36:06] ℹ️ 电池电量: 100%
[17:36:06] ℹ️ 已安装应用: aweme, xhs
[17:36:06] ✅ 设备 雷电模拟器 测试完成
```

## 🎯 下一步计划

- [ ] 设备自动重连功能
- [ ] 设备性能监控
- [ ] 批量设备操作
- [ ] 设备截图预览
- [ ] 应用安装/卸载管理

---

**注意**: 此功能已完全实现并测试通过，可以正常检测和管理你的两个模拟器设备。
